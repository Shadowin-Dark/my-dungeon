!function(e){function t(t){for(var r,l,u=t[0],c=t[1],i=t[2],s=0,f=[];s<u.length;s++)l=u[s],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&f.push(a[l][0]),a[l]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(m&&m(t);f.length;)f.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,u=1;u<n.length;u++){var c=n[u];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=l(l.s=n[0]))}return e}var r={},a={1:0},o=[];function l(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=r,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(n,r,function(t){return e[t]}.bind(null,r));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/my-dungeon/publish/";var u=window.webpackJsonp=window.webpackJsonp||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var i=0;i<u.length;i++)t(u[i]);var m=c;o.push(["tjUo",0]),n()}({tjUo:function(e,t,n){"use strict";n.r(t);var r=n("i8i4"),a=n.n(r),o=(n("QWBl"),n("2B1R"),n("FZtP"),n("q1tI")),l=n.n(o),u=(n("pNMO"),n("4Brf"),n("0oug"),n("TeQF"),n("pjDv"),n("4mDm"),n("+2oP"),n("sMBO"),n("5DmW"),n("27RR"),n("tkto"),n("07d7"),n("JfAA"),n("PKPk"),n("3bBZ"),n("ma9I"),function(e,t){for(var n=[],r=0;r<e;r++){for(var a=[],o=0;o<t;o++)a.push({keyID:"map-unit-".concat(r,"-").concat(o),fieldID:1,hide:!0});n.push(a)}return n}),c=function(e){for(var t=[],n=0;n<e;n++)t.push({id:n+1,STR:4,DEX:4,INT:4,HP:20,ATK:{D:2,V:0},MAG:{D:2,V:0},DEF:2,SPD:{R:2,F:2},EXP:0});return t},i=l.a.createContext({});function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r={map:u(e,t),players:c(n),playerPos:[],focused:{x:-1,y:-1}},a=0;a<n;a++)r.playerPos[a]={x:0,y:0};return r},v=function(e,t){switch(t.type){case"RESET":return t.value;case"FOCUS":var n=t.value,r=n.x,a=n.y;return e.focused.x===r&&e.focused.y===a?e:(e.focused={x:r,y:a},p({},e));case"MOVE":var o=t.value,l=o.x,u=o.y,c=o.playerID;return e.map[l][u].hide=!1,function(e,t,n){var r=e.length,a=0;r>0&&(a=e[0].length);var o=[];return n>0&&o.push({x:t,y:n-1}),n<a-1&&o.push({x:t,y:n+1}),t>0&&(o.push({x:t-1,y:n}),t%2==1&&n>0?o.push({x:t-1,y:n-1}):t%2==0&&n<a-1&&o.push({x:t-1,y:n+1})),t<r-1&&(o.push({x:t+1,y:n}),t%2==1&&n>0?o.push({x:t+1,y:n-1}):t%2==0&&n<a-1&&o.push({x:t+1,y:n+1})),o}(e.map,l,u).forEach((function(t){e.map[t.x][t.y].hide=!1})),e.playerPos[c]={x:l,y:u},p({},e);default:return e}},b={Provider:l.a.memo((function(e){var t=e.children,r=m(Object(o.useReducer)(v,d(0,0)),2),a=r[0],l=r[1];return n("q1tI").createElement(i.Provider,{value:{state:a,dispatch:l}},t)})),Customer:function(e){return l.a.memo((function(){var t=Object(o.useContext)(i),r=t.state,a=t.dispatch;return n("q1tI").createElement(e,{state:r,dispatch:a})}))},Reset:function(e){var t=e.size,n=e.playerNum,r=e.dispatch,a=t.x,o=t.y;r({type:"RESET",value:d(a,o,n)})}},h=n("Ol7k"),I="layout-modules__layout___1vCOx",E="layout-modules__playground___1L4mF",g=h.a.Header,O=h.a.Sider,q=h.a.Content,_=h.a.Footer,j=l.a.memo((function(e){var t=e.Menu,r=e.Players,a=e.Actions,o=e.Map,l=e.Details;return n("q1tI").createElement(h.a,{className:I},n("q1tI").createElement(O,null,n("q1tI").createElement(h.a,null,n("q1tI").createElement(g,null,t),n("q1tI").createElement(q,null,r),n("q1tI").createElement(_,null,a))),n("q1tI").createElement(q,{style:{background:"#bfd8ee"},className:E},o),l&&n("q1tI").createElement(O,null,l))})),P=(n("yXV3"),n("zKZe"),n("tOAR")),w=n("ses9"),x=[{id:0,name:"隐藏",description:"地块被隐藏"},{id:1,name:"测试1",description:"这是一块空地",sideEffect:{movestart:function(e){return e},movein:[0,function(e){return e}],moveout:[0,function(e){return e}],battle:function(e,t){return[e,t]},moveend:function(e){return e}}},{id:2,name:"测试2",description:"进入这里需要额外1SPD",sideEffect:{movestart:function(e){return e},movein:[0,function(e){return e}],moveout:[0,function(e){return e}],battle:function(e,t){return[e,t]},moveend:function(e){return e}}}],S="map-modules__boxFw___3X_uc",D="map-modules__focused___3E_dP",A={field0:"field-modules__field0___uKcyF",field1:"field-modules__field1___1WjUk"};function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var F=l.a.memo((function(e){var t=e.map,r=e.playerPos,a=e.focused,o=e.onFocus;console.log("Rendering Map");var l=function(e){for(var t={},n=0;n<e.length;n++)t["".concat(e[n].x,":").concat(e[n].y)]=n;return t}(r),u=M(function(e){var t=e.length,n=0;return t>0&&(n=e[0].length),[t,n]}(t),2)[1];return n("q1tI").createElement("ul",{className:S,style:{width:"".concat(135*u+100,"px")}},t.map((function(e,t){return e.map((function(e,r){var u=void 0!==l["".concat(t,":").concat(r)]?l["".concat(t,":").concat(r)]:-1,c=t===a.x&&r===a.y?D:"";return n("q1tI").createElement(T,{key:e.keyID,className:c,style:{marginLeft:0===r&&t%2==0?"70px":"2px"},mapUnit:e,userID:u,onClick:function(){return o(t,r)}})}))})))})),T=l.a.memo((function(e){var t=e.mapUnit,r=e.userID,a=e.className,o=C(e,["mapUnit","userID","className"]);if(t.hide)return n("q1tI").createElement("li",N({},o,{className:"".concat(a," ").concat(A.field0)}),n("q1tI").createElement("div",null,"?"));var l=x[t.fieldID];return n("q1tI").createElement("li",N({},o,{className:"".concat(a," ").concat(A["field".concat(l.id)])}),n("q1tI").createElement("div",null,"".concat(l.name)),t.monster&&n("q1tI").createElement("div",null,n("q1tI").createElement(P.a,null)),r>=0&&n("q1tI").createElement("div",null,n("q1tI").createElement(w.a,null)))})),U="details-modules__close-button___196_Y",R="details-modules__field-title___1Q1CK",V="details-modules__field-description___3n-pL",G=l.a.memo((function(e){var t=e.mapUnit,r=e.onClose,a=t.hide,o=t.fieldID,l=x[o];return a?n("q1tI").createElement("div",null,n("q1tI").createElement("button",{className:U,onClick:r,type:"button"},"x"),n("q1tI").createElement("div",{className:R},"?")):n("q1tI").createElement("div",null,n("q1tI").createElement("button",{className:U,onClick:r,type:"button"},"x"),n("q1tI").createElement("div",{className:R},l.name),n("q1tI").createElement("div",{className:V},l.description))}));function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=l.a.memo((function(e){var t=e.players;return console.log("Rendering Players"),n("q1tI").createElement(l.a.Fragment,null,t.map((function(e){return n("q1tI").createElement(H,{key:e.id,player:e})})))})),H=l.a.memo((function(e){var t=e.player,r=K(Object(o.useState)(!0),2),a=r[0],u=r[1];return n("q1tI").createElement(l.a.Fragment,null,n("q1tI").createElement("div",{onClick:function(){return u(!a)}},"Player ".concat(t.id)),a&&n("q1tI").createElement(l.a.Fragment,null,n("q1tI").createElement("div",null,"STR: ".concat(t.STR)),n("q1tI").createElement("div",null,"DEX:".concat(t.DEX)),n("q1tI").createElement("div",null,"INT:".concat(t.INT)),n("q1tI").createElement("div",null,"HP: ".concat(t.HP)),n("q1tI").createElement("div",null,"ATK: ".concat(t.ATK.D,"D + ").concat(t.ATK.V)),n("q1tI").createElement("div",null,"MAG: ".concat(t.MAG.D,"D + ").concat(t.MAG.V)),n("q1tI").createElement("div",null,"DEF:".concat(t.DEF)),n("q1tI").createElement("div",null,"EXP:".concat(t.EXP)),n("q1tI").createElement("div",null,"SPD:".concat(t.SPD.R,"/").concat(t.SPD.F))))})),L=n("Vl3Y"),W=n("kLXV"),$=n("fyUT"),z=n("BvKs"),J=n("jsC+"),Q=n("8Skl");function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(r=(l=u.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te=l.a.memo((function(e){var t=e.visible,r=e.setVisible,a=e.onNewGame,o=Y(L.a.useForm(),1)[0];return n("q1tI").createElement(W.a,{title:"Start a New Game",visible:t,onOk:function(){var e=o.getFieldValue(),t=e.height,n=e.width,l=e.players;a(t,n,l),r(!1)},onCancel:function(){r(!1)}},n("q1tI").createElement(L.a,Z({},{labelCol:{span:8},wrapperCol:{span:16}},{form:o,initialValues:{height:3,width:4,players:1}}),n("q1tI").createElement(L.a.Item,{name:["height"],label:"Height of the Map",rules:[{type:"number",min:0,max:99}]},n("q1tI").createElement($.a,null)),n("q1tI").createElement(L.a.Item,{name:["width"],label:"Width of the Map",rules:[{type:"number",min:0,max:99}]},n("q1tI").createElement($.a,null)),n("q1tI").createElement(L.a.Item,{name:["players"],label:"Player Number",rules:[{type:"number",min:0,max:4}]},n("q1tI").createElement($.a,null))))})),ne=l.a.memo((function(e){var t=e.onNewGame,r=Y(l.a.useState(!1),2),a=r[0],o=r[1],u=n("q1tI").createElement(z.a,null,n("q1tI").createElement(z.a.Item,null,n("q1tI").createElement("div",{onClick:function(){return o(!0)}},"New Game")));return n("q1tI").createElement(l.a.Fragment,null,n("q1tI").createElement(J.a,{overlay:u},n("q1tI").createElement("a",{className:"ant-dropdown-link",onClick:function(e){return e.preventDefault()}},"MENU ",n("q1tI").createElement(Q.a,null))),n("q1tI").createElement(te,{visible:a,setVisible:o,onNewGame:t}))})),re=(n("TpwP"),l.a.memo((function(){return n("q1tI").createElement(b.Provider,null,n("q1tI").createElement(ae,null))}))),ae=b.Customer(l.a.memo((function(e){var t=e.state,r=e.dispatch,a=t.map,o=t.playerPos,l=t.focused;console.log("state",t);var u=!(-1===l.x&&-1===l.y);return n("q1tI").createElement(j,{Menu:n("q1tI").createElement(ne,{onNewGame:function(e,n,a){b.Reset({size:{x:e,y:n},playerNum:a,dispatch:r}),t.playerPos.forEach((function(e,t){r({type:"MOVE",value:{x:e.x,y:e.y,playerID:t}})}))}}),Players:n("q1tI").createElement(B,{players:t.players}),Actions:n("q1tI").createElement("div",null,n("q1tI").createElement("button",{type:"submit",onClick:function(){return r({type:"MOVE",value:{x:l.x,y:l.y,playerID:0}})}},"Move")),Map:n("q1tI").createElement(F,{map:a,playerPos:o,focused:l,onFocus:function(e,t){return r({type:"FOCUS",value:{x:e,y:t}})}}),Details:u&&n("q1tI").createElement(G,{mapUnit:a[l.x][l.y],onClose:function(){return r({type:"FOCUS",value:{x:-1,y:-1}})}})})})));a.a.render(n("q1tI").createElement(re,null),document.getElementById("app"))}});