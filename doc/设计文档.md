# 设计文档

## 胜利条件

完成游戏特定的胜利条件

## 地图

地图由 N*M 六边形（蜂巢状）地块构成，不同地块会有不同的效果

效果包括：

1. **启动** - 回合开始时若玩家处在该地块，则触发该效果
2. **移入** - 玩家移动进入该地块，则触发该效果
3. **移出** - 玩家移动走出该地块，则触发该效果
4. **战斗** - 玩家在该地块发生战斗，则触发该效果
5. **停留** - 回合结束时若玩家处于该地块，则触发该效果

## 玩家属性

玩家有力量（STR)，敏捷(DEX)，智力(INT)，生命(HP)四项属性

引申为物理攻击(ATK)，法术攻击(MAG)，速度(SPD)，防御(DEF)四项能力

1. **力量** - STR - 初始化为4点，上限为10点，每2点力量增加1d物理攻击(ATK)
2. **敏捷** - DEX - 初始化为4点，上限为10点，每2点敏捷增加1点速度(SPD)，每3点敏捷增加1点防御(DEF)
3. **智力** - INT - 初始化为4点，上限为10点，每2点智力增加1d法术攻击(MAG)
4. **生命** - HP - 初始化为20点，生命值为0时，玩家阵亡，游戏失败
5. **速度** - SPD - 速度为玩家可以在地图上的移动地块数
6. **物理攻击** - ATK
7. **魔法攻击** - MAG
8. **防御** - DEF

玩家可以通过地图任务，或者在指定地块上进行修炼提高对应属性和能力值。也可以通过获取经验值EXP的方式，每获得6点EXP则可以增加任意点属性值，对换规则：

1. 6 EXP -> 1 STR
2. 6 EXP -> 1 DEX
3. 6 EXP -> 1 INT

## 装备

玩家可以装备主手武器，副手武器，头饰，护甲，鞋子，用于提升个人属性，能力

1. 主手武器 - RIGHT
2. 副手武器 - LEFT
3. 头饰 - HEAD
4. 护甲 - ARMOR
5. 鞋子 - SHOES
6. 配饰 - ACCESSOR

每一个装备位置只能装备1或0件装备，当装备被替换时会被丢弃，特别的，双手武器会同时占用主手武器和副手武器位置

装备可以通过地图获得，也可以通过击败怪物获得

装备的效果包括：

1. 属性、能力加成
2. 装备时触发效果
3. 移除时触发效果

## 怪物

怪物随机出现在地图的随机地块上，按照强度分为1-4等级，击败会获得1-4EXP，同时也会获得不同的奖励

怪物拥有ATK/MAG和HP属性，和数条额外属性

## 战斗

战斗时可以使用ATK或者MAG进行攻击，由玩家触发的物理攻击可直接触发，法术攻击需要装备法杖

攻击数值格式为： N*d + M

实际的攻击力计算方式：投掷N个骰子，点数相加再额外加M

战斗会消耗剩余全部的速度值 SPD

### 玩家与怪物的战斗回合流程

1. 计算怪物的实际攻击力 DEMAGE_M
2. 若DEMAGE_M > 玩家防御力 DEF，玩家 HP-1
3. 计算玩家实际攻击力 DEMAGE_U
4. 怪物 HP - DEMAGE_U
5. 若怪物 HP <= 0，则战斗胜利，若玩家 HP <= 0，则战斗失败
6. 若玩家选择逃跑，则通过怪物的逃跑规则进行计算，若逃跑成功，怪物HP回到默认值
7. 若没有选择逃跑，重复回合知道玩家或怪物一方HP <= 0

### 玩家之间的战斗回合

1. 计算战斗发起玩家A的的实际攻击力 DEMAGE_1
2. 若DEMAGE_1大于被攻击玩家B的防御值DEF_2，则玩家B HP_2-(DEMAGE_1-DEF_2)
3. 计算玩家B的的实际攻击力 DEMAGE_2
4. 若DEMAGE_2大于玩家A的防御值DEF_1，则玩家A HP_1-(DEMAGE_2-DEF_1)

## 游戏流程

初始化地图与怪物，初始时地块均为翻面（不可见）状态

玩家初始化属性点，并出生于地图上某一个无怪物地块，每回合玩家可以：基于SPD自由探索地图，与特定地块互动或战斗

直至达成胜利条件，则玩家获胜

若玩家HP为0，则玩家失败

### 每个玩家每回合流程

1. 启动阶段
   1. 触发玩家所在地块**启动**效果
   2. 玩家重置SPD
2. 移动阶段
   1. 玩家可选择移动到相邻的地块，并消耗1点SPD，若地块为翻面状态，则正面该地块，触发该地块的**移入**效果
   2. 若新地块存在怪物，则强制触发与怪物的战斗，进入战斗阶段
   3. 若新地块存在其他玩家，则可以选择发起战斗，进入战斗阶段
   4. 若新地块不存在怪物，且玩家SPD>0，则玩家可以选择继续移动，若此，则触发该地块的**移出**效果
3. 战斗阶段
   1. 按照 **战斗** 进行战斗，之后进入结束阶段
   2. 与怪物战斗时，玩家也可选择逃跑，逃跑成功后，玩家与怪物同时处在当前地块，之后进入结束阶段
4. 结束阶段
   1. 触发该地块的**停留**效果
